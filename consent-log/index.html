<!doctype html>
<html lang="en">

<head>
    <script>
        var LOCALE = 'en\u002DUS';
        var BASE_URL = 'https\u003A\u002F\u002Fwww.vanguardpharmacy.ca\u002F';
        var require = {
            'baseUrl': 'https\u003A\u002F\u002Fwww.vanguardpharmacy.ca\u002Fstatic\u002Fversion1763691675\u002Ffrontend\u002FRexall\u002Fdefault\u002Fen_US'
        };
    </script>
    <meta charset="utf-8" />
    <meta name="title" content="vanguardpharmacy.ca | Cookie Consent Log" />
    <meta name="description"
        content="Admin view for cookie consent logs and user preferences." />
    <meta name="robots" content="NOINDEX,NOFOLLOW" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="format-detection" content="telephone=no" />
    <title>vanguardpharmacy.ca | Cookie Consent Log</title>
    <link rel="stylesheet" type="text/css" media="all"
        href="/static/version1763691675/frontend/Rexall/default/en_US/mage/calendar.css?t=1763691705" />
    <link rel="stylesheet" type="text/css" media="all"
        href="/static/version1763691675/frontend/Rexall/default/en_US/css/styles-m.css?t=1763691728" />
    <link rel="stylesheet" type="text/css" media="all"
        href="/static/version1763691675/frontend/Rexall/default/en_US/jquery/uppy/dist/uppy-custom.css?t=1763691705" />
    <link rel="stylesheet" type="text/css" media="all"
        href="/static/version1763691675/frontend/Rexall/default/en_US/Northern_Banner/css/banner.css?t=1763691708" />
    <link rel="stylesheet" type="text/css" media="screen and (min-width: 768px)"
        href="/static/version1763691675/frontend/Rexall/default/en_US/css/styles-l.css?t=1763691713" />
    <link rel="stylesheet" type="text/css" media="print"
        href="/static/version1763691675/frontend/Rexall/default/en_US/css/print.css?t=1763691710" />
    <link rel="canonical" href="/consent-log" />
    <link rel="icon" type="image/x-icon" href="/public/images/favicon.ico" />
    <link rel="shortcut icon" type="image/x-icon" href="/public/images/favicon.ico" />
    <!-- Cookie Consent Styles -->
    <link rel="stylesheet" type="text/css" href="/static/css/cookie-consent.css" />
    <script type="application/ld+json">
        {
            "@context": "http:\/\/schema.org",
            "@type": "Organization",
            "name": "Vanguard Pharmacy",
            "url": "https:\/\/www.vanguardpharmacy.ca",
            "logo": "https:\/\/www.vanguardpharmacy.ca\/media\/organization_data\/logo\/default\/RX-Logo.jpg",
            "sameAs": ["http:\/\/www.facebook.com\/vanguardpharmacy", "http:\/\/instagram.com\/vanguardpharmacy", "http:\/\/www.twitter.com\/vanguardpharmacy", "https:\/\/www.youtube.com\/user\/vanguardpharmacy", "https:\/\/www.linkedin.com\/company\/vanguardpharmacy"]
        }
    </script>
    <script>
        if (!BASE_URL) {
            var BASE_URL = "https:\/\/www.vanguardpharmacy.ca\/";
        }
        var STORE_CODE = "default";
    </script>
    <script>
        function getBaseURL() {
            return "https:\/\/www.vanguardpharmacy.ca\/";
        }
    </script>
</head>

<body data-container="body" id="html-body"
    class="cms-consent-log cms-page-view page-layout-pharmacy-sidebar-view">

    <div class="page-wrapper">
        <div class="skip-link-container"><a class="skip-link js-immediate-focus js-main-skip-link" href="#contentarea"
                data-focus-target="" data-transition-duration="">
                Skip to main content</a>
        </div>
        <header class="page-header nnew">
            <div class="header content">
                <div class="header-desktop-container width-container"> <strong class="logo"><a href="/"><img
                                src="/public/images/vanguard-logo.png" alt="Vanguard Pharmacy"
                                style="height: 80px;"></a></strong>
                    <nav class="nav right">
                        <ul class="header-nav">
                            <li class="has-menu js-menu-item header-nav-level-0">
                                <a href="/pharmacy/" class="header-btn">Pharmacy</a>
                            </li>
                            <li class="has-menu js-menu-item header-nav-level-0">
                                <a href="/everyday-health/" class="header-btn">Everyday Health</a>
                            </li>
                        </ul>
                        <div class="hp-header-buttons-block">
                            <ul class="button-container icon-buttons">
                                <li><a class="btn store-locator" href="/contact-us/"><span
                                            class="button-icon"></span><span class="desktop-text">Find a
                                            Store</span><span class="mobile-text">Stores</span></a></li>
                            </ul>
                        </div>
                    </nav>
                </div>
            </div>
        </header>
        <div class="breadcrumb-wrap">
            <div class="inner">
                <div class="breadcrumbs">
                    <ul class="items">
                        <li class="item home">
                            <a href="/" title="Go to Home Page">
                                Home </a>
                        </li>
                        <li class="item cms_page">
                            <strong>Cookie Consent Log</strong>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <main id="maincontent" class="page-main"><a id="contentarea" tabindex="-1"></a>
            <div class="columns pharmacy-columns">
                <div class="main pharmacy-page-content">
                    <div class="legacy-section">
                        <div id="content-header-title" class="section content-header-title">
                            <h1 class="light-teal-title">Cookie Consent Log</h1>
                            <p class="sub-title-dark">Admin View - Real-time Cookie Consent States</p>
                        </div>

                        <div id="special-content">
                            <div class="consent-log-container">
                                <div class="consent-log-header">
                                    <h2>Consent Records</h2>
                                    <div class="consent-log-actions">
                                        <button type="button" class="refresh-btn" id="refresh-logs">
                                            Refresh
                                        </button>
                                        <button type="button" class="export-btn" id="export-logs">
                                            Export CSV
                                        </button>
                                    </div>
                                </div>

                                <div class="current-user-status" style="background: #f5f5f5; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                                    <h3 style="margin-top: 0;">Current User Preferences</h3>
                                    <div id="current-preferences">
                                        <p>Loading current preferences...</p>
                                    </div>
                                </div>

                                <div id="consent-log-content">
                                    <p class="consent-log-empty">Loading consent logs...</p>
                                </div>

                                <div style="margin-top: 30px; padding: 20px; background: #fff3cd; border-radius: 8px; border: 1px solid #ffc107;">
                                    <h3 style="margin-top: 0; color: #856404;">Implementation Note</h3>
                                    <p style="color: #856404; margin-bottom: 0;">
                                        This demo uses localStorage to store consent logs on the client side. 
                                        In a production environment, you would integrate this with a server-side 
                                        logging system (database, analytics platform, or compliance management tool) 
                                        to centrally store and manage consent records across all users.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="pharmacy-sidebar">
                    <div class="pharmacy-sidebar-block sidebar-prescriptions">
                        <div class="pharmacy-sidebar-content">
                            <h3 class="pharmacy-sidebar-title">Related Links</h3>
                        </div>
                        <a class="pharmacy-sidebar-button" href="/cookie-policy/">Cookie Policy</a>
                        <a class="pharmacy-sidebar-button" href="/privacy-policy/">Privacy Policy</a>
                    </div>
                </div>
            </div>
        </main>
        <footer class="page-footer nn">
            <div class="footer top">
                <div class="footer-top-wrapper width-container">
                    <a class="logo" href="/"><img src="/public/images/vanguard-logo.png" alt="Vanguard Pharmacy"
                            style="height: 80px;"></a>
                    <div class="button-container">
                        <a class="btn large store-locator" href="/contact-us/">Find a Store</a>
                    </div>
                </div>
            </div>
            <div class="footer middle">
                <div class="clearfix link-wrap width-container">
                    <ul class="footer-accessible-accordion">
                        <li class="footer-accessible-accordion-item js-accessible-accordion-item">
                            <h2 class="footer-nav-title"><span class="footer-nav-title-link">Resources</span></h2>
                            <div class="footer-accessible-accordion-content footer-accessible-accordion-content-double-list js-accessible-accordion-content">
                                <ul class="footer-accessible-accordion-content-list-one">
                                    <li><a href="/contact-us/" class="footer-btn">Contact Us</a></li>
                                    <li><a href="/privacy-policy/" class="footer-btn">Privacy Policy</a></li>
                                    <li><a href="/cookie-policy/" class="footer-btn">Cookie Policy</a></li>
                                </ul>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="footer bottom">
                <div class="footer-disclaimer-container width-container">
                    <div class="footer-disclaimer">
                        <p>© 2025 Vanguard Pharmacy. All rights reserved.</p>
                    </div>
                </div>
            </div>
        </footer>

        <!-- Cookie Preferences Button -->
        <button type="button" class="cookie-preferences-btn" aria-label="Cookie Preferences">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/>
            </svg>
            Cookie Settings
        </button>

        <!-- Cookie Consent Script -->
        <script src="/static/js/cookie-consent.js"></script>

        <!-- Consent Log Display Script -->
        <script>
            (function() {
                'use strict';

                function formatDate(dateString) {
                    var date = new Date(dateString);
                    return date.toLocaleString('en-CA', {
                        year: 'numeric',
                        month: 'short',
                        day: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit',
                        second: '2-digit'
                    });
                }

                function getStatusHTML(value) {
                    if (value === true) {
                        return '<span class="consent-status-yes">✓ Yes</span>';
                    }
                    return '<span class="consent-status-no">✗ No</span>';
                }

                function displayCurrentPreferences() {
                    var container = document.getElementById('current-preferences');
                    if (!container || !window.CookieConsent) {
                        if (container) {
                            container.innerHTML = '<p>Cookie consent system not loaded.</p>';
                        }
                        return;
                    }

                    var prefs = window.CookieConsent.getPreferences();
                    
                    if (!prefs) {
                        container.innerHTML = '<p><em>No consent preferences set yet. The user has not made a choice.</em></p>';
                        return;
                    }

                    var html = '<table class="consent-log-table" style="max-width: 500px;">';
                    html += '<tr><th>Category</th><th>Status</th></tr>';
                    html += '<tr><td>Necessary Cookies</td><td>' + getStatusHTML(true) + ' (Always required)</td></tr>';
                    html += '<tr><td>Analytics Cookies</td><td>' + getStatusHTML(prefs.analytics) + '</td></tr>';
                    html += '<tr><td>Marketing Cookies</td><td>' + getStatusHTML(prefs.marketing) + '</td></tr>';
                    html += '</table>';
                    html += '<p style="margin-top: 10px; color: #666; font-size: 13px;">Last updated: ' + (prefs.timestamp ? formatDate(prefs.timestamp) : 'Unknown') + '</p>';

                    container.innerHTML = html;
                }

                function displayConsentLogs() {
                    var container = document.getElementById('consent-log-content');
                    if (!container || !window.CookieConsent) {
                        if (container) {
                            container.innerHTML = '<p class="consent-log-empty">Cookie consent system not loaded.</p>';
                        }
                        return;
                    }

                    var logs = window.CookieConsent.getConsentLogs();
                    
                    if (!logs || logs.length === 0) {
                        container.innerHTML = '<p class="consent-log-empty">No consent records found. Records will appear after users interact with the cookie consent dialog.</p>';
                        return;
                    }

                    // Reverse to show most recent first
                    logs = logs.slice().reverse();

                    var html = '<table class="consent-log-table">';
                    html += '<thead><tr>';
                    html += '<th>Timestamp</th>';
                    html += '<th>Action</th>';
                    html += '<th>Necessary</th>';
                    html += '<th>Analytics</th>';
                    html += '<th>Marketing</th>';
                    html += '</tr></thead>';
                    html += '<tbody>';

                    logs.forEach(function(log) {
                        html += '<tr>';
                        html += '<td>' + formatDate(log.timestamp) + '</td>';
                        html += '<td>' + (log.action === 'initial' ? 'Initial Consent' : 'Updated') + '</td>';
                        html += '<td>' + getStatusHTML(log.preferences.necessary) + '</td>';
                        html += '<td>' + getStatusHTML(log.preferences.analytics) + '</td>';
                        html += '<td>' + getStatusHTML(log.preferences.marketing) + '</td>';
                        html += '</tr>';
                    });

                    html += '</tbody></table>';
                    html += '<p style="margin-top: 15px; color: #666; font-size: 13px;">Showing ' + logs.length + ' consent record(s)</p>';

                    container.innerHTML = html;
                }

                function exportToCSV() {
                    if (!window.CookieConsent) {
                        alert('Cookie consent system not loaded.');
                        return;
                    }

                    var logs = window.CookieConsent.getConsentLogs();
                    
                    if (!logs || logs.length === 0) {
                        alert('No consent records to export.');
                        return;
                    }

                    var csv = 'Timestamp,Action,Necessary,Analytics,Marketing\n';
                    
                    logs.forEach(function(log) {
                        csv += '"' + log.timestamp + '",';
                        csv += '"' + log.action + '",';
                        csv += '"' + (log.preferences.necessary ? 'Yes' : 'No') + '",';
                        csv += '"' + (log.preferences.analytics ? 'Yes' : 'No') + '",';
                        csv += '"' + (log.preferences.marketing ? 'Yes' : 'No') + '"\n';
                    });

                    var blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
                    var link = document.createElement('a');
                    var url = URL.createObjectURL(blob);
                    link.setAttribute('href', url);
                    link.setAttribute('download', 'cookie_consent_log_' + new Date().toISOString().split('T')[0] + '.csv');
                    link.style.visibility = 'hidden';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                }

                function init() {
                    displayCurrentPreferences();
                    displayConsentLogs();

                    // Refresh button
                    var refreshBtn = document.getElementById('refresh-logs');
                    if (refreshBtn) {
                        refreshBtn.addEventListener('click', function() {
                            displayCurrentPreferences();
                            displayConsentLogs();
                        });
                    }

                    // Export button
                    var exportBtn = document.getElementById('export-logs');
                    if (exportBtn) {
                        exportBtn.addEventListener('click', exportToCSV);
                    }
                }

                // Wait for CookieConsent to be available
                if (document.readyState === 'loading') {
                    document.addEventListener('DOMContentLoaded', function() {
                        setTimeout(init, 100);
                    });
                } else {
                    setTimeout(init, 100);
                }
            })();
        </script>
    </div>
</body>

</html>
